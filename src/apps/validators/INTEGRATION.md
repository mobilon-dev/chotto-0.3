# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ MobilonExtendedChatApp

–í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã —á–∞—Ç–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `MobilonExtendedChatApp.vue` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

### –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:

#### 1. –ò–º–ø–æ—Ä—Ç –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤

```typescript
import { useChatValidator } from "../validators/chats";
import { useMessageValidator } from "../validators/messages";
// –ò–ª–∏
// import { useChatValidator, useMessageValidator } from "../validators";
```

#### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ

```typescript
// –†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–∞—Ç–æ–≤
const chatsData = computed(() => chatsStore.chats);
const { 
  isValid: isChatsValid, 
  errorCount: chatErrorCount, 
  showReport: showChatsReport 
} = useChatValidator(chatsData, {
  autoValidate: true,  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
  debounce: 300        // –ó–∞–¥–µ—Ä–∂–∫–∞ 300–º—Å –ø–µ—Ä–µ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
});

// –†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
const { 
  isValid: isMessagesValid, 
  errorCount: messageErrorCount, 
  showReport: showMessagesReport 
} = useMessageValidator(messages, {
  autoValidate: true,
  debounce: 300
});
```

**–í–æ—Ç –∏ –≤—Å—ë!** –¢—Ä–∏ —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ - –∏ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç.

#### 3. UI-–∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–∑–æ–≤–∞ –æ—Ç—á–µ—Ç–æ–≤

–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–≤–µ –∫–Ω–æ–ø–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–≤ ChatInfo actions):

**–ö–Ω–æ–ø–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —á–∞—Ç–æ–≤:**
```vue
<button
  class="chat-info__button-panel chat-info__button-validation"
  :class="{ 'validation-error': !isChatsValid }"
  :title="isChatsValid ? '–ß–∞—Ç—ã –≤–∞–ª–∏–¥–Ω—ã ‚úì' : `–û—à–∏–±–æ–∫ –≤ —á–∞—Ç–∞—Ö: ${chatErrorCount}`"
  @click="showChatsReport"
>
  <span class="validation-icon validation-icon--chats">{{ isChatsValid ? '‚úì' : '!' }}</span>
</button>
```

**–ö–Ω–æ–ø–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:**
```vue
<button
  class="chat-info__button-panel chat-info__button-validation chat-info__button-validation--messages"
  :class="{ 'validation-error': !isMessagesValid }"
  :title="isMessagesValid ? '–°–æ–æ–±—â–µ–Ω–∏—è –≤–∞–ª–∏–¥–Ω—ã ‚úì' : `–û—à–∏–±–æ–∫ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö: ${messageErrorCount}`"
  @click="showMessagesReport"
>
  <span class="validation-icon validation-icon--messages">{{ isMessagesValid ? '‚úâ' : '!' }}</span>
</button>
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–Ω–æ–ø–æ–∫:**

**–ö–Ω–æ–ø–∫–∞ —á–∞—Ç–æ–≤:**
- ‚úÖ **–ó–µ–ª–µ–Ω–∞—è –≥–∞–ª–æ—á–∫–∞** (‚úì) - –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–Ω—ã
- üü¢ **–ó–µ–ª–µ–Ω—ã–π —Ñ–æ–Ω** –ø—Ä–∏ hover
- ‚ùå **–ö—Ä–∞—Å–Ω—ã–π –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫** (!) - –∫–æ–≥–¥–∞ –µ—Å—Ç—å –æ—à–∏–±–∫–∏

**–ö–Ω–æ–ø–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π:**
- ‚úâÔ∏è **–°–∏–Ω–∏–π –∫–æ–Ω–≤–µ—Ä—Ç** (‚úâ) - –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–Ω—ã
- üîµ **–°–∏–Ω–∏–π —Ñ–æ–Ω** –ø—Ä–∏ hover
- ‚ùå **–ö—Ä–∞—Å–Ω—ã–π –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫** (!) - –∫–æ–≥–¥–∞ –µ—Å—Ç—å –æ—à–∏–±–∫–∏

**–û–±—â–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- üîÑ **–ü—É–ª—å—Å–∏—Ä—É—é—â–∞—è –∞–Ω–∏–º–∞—Ü–∏—è** - –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ—à–∏–±–æ–∫
- üí¨ **Tooltip** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
- üñ±Ô∏è **–ö–ª–∏–∫** - –≤—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è**: 
   - –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `chatsStore.chats` ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–∞—Ç–æ–≤ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 300–º—Å
   - –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `messages` ‚Üí –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 300–º—Å

2. **–î–≤–µ –∫–Ω–æ–ø–∫–∏ –≤ UI**:
   - üü¢ –ó–µ–ª–µ–Ω–∞—è (‚úì) - –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–∞—Ç–æ–≤
   - üîµ –°–∏–Ω—è—è (‚úâ) - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

3. **–í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å**: –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –≤—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç

4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ë–ª–∞–≥–æ–¥–∞—Ä—è debounce –∏ computed —Å–≤–æ–π—Å—Ç–≤–∞–º

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å:

```
üìã –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —á–∞—Ç–æ–≤
=== –†–ï–ó–£–õ–¨–¢–ê–¢ –í–ê–õ–ò–î–ê–¶–ò–ò –ß–ê–¢–û–í ===

‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—à–∏–±–∫–∏!

üî¥ –û–®–ò–ë–ö–ò (3):
  1. [chats[0].chatId] –ü–æ–ª–µ chatId –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–∏—Å–ª–æ–º
     –ó–Ω–∞—á–µ–Ω–∏–µ: undefined
  2. [chats[1].name] –ü–æ–ª–µ name –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π
     –ó–Ω–∞—á–µ–Ω–∏–µ: 123
  3. [chats[2].countUnread] –ü–æ–ª–µ countUnread –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
     –ó–Ω–∞—á–µ–Ω–∏–µ: -5

===================================

üìä –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫:

üî¥ –ß–∞—Ç [0] - –æ—à–∏–±–æ–∫: 1

1. chats[0].chatId
   –°–æ–æ–±—â–µ–Ω–∏–µ: –ü–æ–ª–µ chatId –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–∏—Å–ª–æ–º
   –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è: undefined

üì¶ –ü–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç —á–∞—Ç–∞:
{
  chatId: undefined,
  name: "–¢–µ—Å—Ç",
  countUnread: 0,
  lastMessage: "test",
  lastActivity.timestamp: "1727021159",
  ...
}

üî¥ –ß–∞—Ç [1] - –æ—à–∏–±–æ–∫: 1

2. chats[1].name
   –°–æ–æ–±—â–µ–Ω–∏–µ: –ü–æ–ª–µ name –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π
   –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è: 123

üì¶ –ü–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç —á–∞—Ç–∞:
{
  chatId: 1,
  name: 123,
  countUnread: 0,
  ...
}

üî¥ –ß–∞—Ç [2] - –æ—à–∏–±–æ–∫: 1

3. chats[2].countUnread
   –°–æ–æ–±—â–µ–Ω–∏–µ: –ü–æ–ª–µ countUnread –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
   –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è: -5

üì¶ –ü–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç —á–∞—Ç–∞:
{
  chatId: 2,
  name: "–¢–µ—Å—Ç 2",
  countUnread: -5,
  ...
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞:**
- ‚úÖ –û—à–∏–±–∫–∏ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —á–∞—Ç–∞–º
- ‚úÖ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ —á–∞—Ç–∞ –ø–æ–∫–∞–∑–∞–Ω –ø–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç
- ‚úÖ –õ–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
- ‚úÖ –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –æ–±—ä–µ–∫—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä:

```vue
<script setup>
import { computed } from 'vue';
import { useChatValidator } from '@/apps/validators/chats';
import { useChatsStore } from '@/apps/stores/useChatStore';

const chatsStore = useChatsStore();
const chatsData = computed(() => chatsStore.chats);

// –ü—Ä–æ—Å—Ç–æ –ø–æ–¥–∫–ª—é—á–∞–µ–º - –∏ –≥–æ—Ç–æ–≤–æ!
const { showReport } = useChatValidator(chatsData, {
  autoValidate: true,
  debounce: 300
});

// –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –æ—Ç—á–µ—Ç –≤—Ä—É—á–Ω—É—é
// showReport();
</script>
```

### –° –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

```vue
<script setup>
import { computed, watch } from 'vue';
import { useChatValidator } from '@/apps/validators';
import { useChatsStore } from '@/apps/stores/useChatStore';

const chatsStore = useChatsStore();
const chatsData = computed(() => chatsStore.chats);

const { isValid, errorCount, showReport } = useChatValidator(chatsData, {
  autoValidate: true,
  debounce: 300
});

// –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
watch(isValid, (valid) => {
  if (!valid) {
    console.warn(`‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ ${errorCount.value} –æ—à–∏–±–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö —á–∞—Ç–æ–≤`);
    // –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —Ç–æ—Å—Ç-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫—É
  }
});
</script>
```

### –¢–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```vue
<script setup>
const { isValid, errors } = useChatValidator(chatsData, {
  autoValidate: import.meta.env.DEV  // –¢–æ–ª—å–∫–æ –≤ dev —Ä–µ–∂–∏–º–µ
});
</script>

<template>
  <div v-if="import.meta.env.DEV && !isValid">
    <!-- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ -->
  </div>
</template>
```

## –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ç–æ—Ä, –ø—Ä–æ—Å—Ç–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—ã–∑–æ–≤ `useChatValidator`:

```typescript
// const { isValid, errors } = useChatValidator(chatsData, {
//   autoValidate: true,
//   debounce: 300
// });
```

–ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `autoValidate` –Ω–∞ `false` –∏ –≤—ã–∑—ã–≤–∞–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é.

## Production —Ä–µ–∂–∏–º

–í production –≤–∞–ª–∏–¥–∞—Ç–æ—Ä –º–æ–∂–Ω–æ:
1. –û—Å—Ç–∞–≤–∏—Ç—å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
2. –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö
3. –°–∫—Ä—ã—Ç—å UI, –Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–ü—Ä–∏–º–µ—Ä –¥–ª—è production:

```typescript
const { isValid, errors, validate } = useChatValidator(chatsData, {
  autoValidate: import.meta.env.DEV,  // –ê–≤—Ç–æ —Ç–æ–ª—å–∫–æ –≤ dev
  debounce: 500
});

// –í production - –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
if (import.meta.env.PROD && !isValid.value) {
  sendToMonitoring('chat-validation-errors', {
    errorCount: errors.value.length,
    errors: errors.value
  });
}
```

